<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'>
	<meta name='viewport' content='width=device-width, initial-scale=1.0'>
	<title>Calendar</title>
	<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.css' />
	<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.print.min.css' media='print' />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.2/css/bootstrap.min.css">
	<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.2/js/bootstrap.min.js"></script>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js'></script>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.js'></script>
	
</head>
<style>

* {
	box-sizing: border-box;
}
h1 {
	text-align: center;
	position: relative;
	color: white;
}
#create-event-btn {
  display: inline-block;
  margin-right: 20px;
  text-align: center
}
#show-matches-btn {
  display: inline-block;
}
.switch {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
}

.switch input { 
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  -webkit-transition: .4s;
  transition: .4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  -webkit-transition: .4s;
  transition: .4s;
}

input:checked + .slider {
  background-color: #2196F3;
}

input:focus + .slider {
  box-shadow: 0 0 1px #2196F3;
}

input:checked + .slider:before {
  -webkit-transform: translateX(26px);
  -ms-transform: translateX(26px);
  transform: translateX(26px);
}
/* Rounded sliders */
.slider.round {
  border-radius: 34px;
}

.slider.round:before {
  border-radius: 50%;
}

#calendar-container {
	max-width: 900px;
	margin: 40px auto;
	padding: 0 10px;
}
</style>
<body>
	<header>
		<nav class="navBar">
			<span>
				<a class="navButton floatLeft" href="{{ url_for('profile.index')}}">Home</a>
				<a class="navButton floatLeft" href="{{ url_for('profile.calendar') }}">Calendar</a>
				<a class="navButton floatLeft" href="{{ url_for('profile.tasks') }}">Tasks</a>
				<a class="navButton floatLeft" href="{{ url_for('profile.progress') }}">Progress</a>
			</span>
			<span>
				<a class="navButton floatRight" href="{{ url_for('auth.logout') }}">Log Out</a>
			</span>
		</nav>
	</header>
	<h1>TBD Planner</h1> 
	<button id="create-event-btn">Create Event</button>
	<h3>Show Matches</h3>
	<label class="switch">
		<input type="checkbox" id="toggle-switch">
		<span class="slider round"></span>
	  </label>
	<div id="create-event-modal" class="modal" hidden>
		<div class="modal-content">
		  <span class="close">&times;</span>
		  <h2>Create Event</h2>
		  <form id="create-event-form">
			<label for="title">Title:</label>
			<input type="text" id="title" name="title" required>

			<label for="start-date">Start Date:</label>
      		<input type="date" id="start-date" name="start-date" required>

      		<label for="start-time">Start Time:</label>
      		<input type="time" id="start-time" name="start-time" required>

      		<label for="end-date">End Date:</label>
      		<input type="date" id="end-date" name="end-date" required>

      		<label for="end-time">End Time:</label>
      		<input type="time" id="end-time" name="end-time" required>

			<button type="submit">Create</button>
		  </form>
		</div>
	  </div>

	<div id='calendar-container'>
		<div id='calendar'></div>
		<div id='script-warning' style='display: none;'>Error getting data from <code>/data</code> endpoint.</div>
		<div id='loading' style='display: none;'>Loading...</div>
	</div>
	
	<script>
		$(document).ready(function() {
  // Show the create event modal when the button is clicked
  $('#create-event-btn').click(function() {
    $('#create-event-modal').show();
  });

  // Hide the create event modal when the close button is clicked
  $('.close').click(function() {
    $('#create-event-modal').hide();
  });

  // Handle form submission
  $('#create-event-form').submit(function(event) {
    event.preventDefault();

    // Get the values from the form
    var title = $('#title').val();
    var start_date = $('#start-date').val();
    var end_date = $('#end-date').val();
    var start_time = $('#start-time').val();
    var end_time = $('#end-time').val();

    // TODO: send the data to the server to create the event

    // Close the modal dialog
    $('#create-event-modal').hide();
  });

  $('#toggle-switch').change(function() {
    // Get the current state of the switch (on or off)
    var showMatches = $('#toggle-switch').is(':checked');

    if (showMatches) {
      // Add the datamatches event source to the calendar
      $('#calendar').fullCalendar('addEventSource', {
        url: '/datamatches',
        color: 'orange',
        error: function() {
          $('#script-warning').show();
        }
      });
    } else {
      // Remove the datamatches event source from the calendar
      $('#calendar').fullCalendar('removeEventSource', '/datamatches');
    }
  });

  $('#calendar').fullCalendar({
    header: {
      left: 'prev,next today',
      center: 'title',
      right: 'month,agendaWeek,agendaDay'
    },
    defaultDate: '2023-04-12',
    editable: true,
    eventLimit: true,
    eventSources: [
      {
        url: 'data',
        color: 'blue',
        error: function() {
          $('#script-warning').show();
        }
      }
    ],
    loading: function(bool) {
      $('#loading').toggle(bool);
    }
  });
});
	</script>
</body>
</html>